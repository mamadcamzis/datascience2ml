2024-10-19 02:54:22.851 | INFO     | __main__:main:18 - Starting the prediction process, running         the application ...
2024-10-19 02:54:22.857 | INFO     | model.model_builder:train_model:47 - Checking the existence of model config file ...
2024-10-19 02:54:22.858 | WARNING  | model.model_builder:train_model:55 - Model not found at model/models/random_forest_db_version_0.1.0.joblib -> Building a new random_forest_db model ...
2024-10-19 02:54:22.858 | INFO     | model.pipeline.model:build_model:42 - Starting  Building Model Pipeline ...
2024-10-19 02:54:22.858 | INFO     | model.pipeline.preparation:prepare_data:33 - Preparing data pipeline processing ...
2024-10-19 02:54:22.858 | INFO     | model.pipeline.collect:load_data_from_db:53 - Loading data from database ...
2024-10-19 02:54:22.898 | INFO     | model.pipeline.preparation:encode_cat_cols:79 - Encoding categorical columns ['balcony', 'parking', 'furnished', 'garage', 'storage']
2024-10-19 02:54:22.915 | INFO     | model.pipeline.preparation:parse_garden_col:106 - Parsing garden column ...
2024-10-19 02:54:22.917 | INFO     | model.pipeline.model:_get_x_y:99 - Getting X, y data ...
2024-10-19 02:54:22.918 | ERROR    | __main__:<module>:29 - An error has been caught in function '<module>', process 'MainProcess' (4776), thread 'MainThread' (140710239363200):
Traceback (most recent call last):

> File "/home/mamadou/datascience2ml/src/runner_builder.py", line 29, in <module>
    main()
    └ <function main at 0x7ff9a6fac540>

  File "/home/mamadou/datascience2ml/src/runner_builder.py", line 24, in main
    ml_svc.train_model()
    │      └ <function ModelBuilderService.train_model at 0x7ff973813920>
    └ <model.model_builder.ModelBuilderService object at 0x7ff9a61f7710>

  File "/home/mamadou/datascience2ml/src/model/model_builder.py", line 60, in train_model
    build_model()
    └ <function build_model at 0x7ff9a6d20220>

  File "/home/mamadou/datascience2ml/src/model/pipeline/model.py", line 46, in build_model
    X, y = _get_x_y(dataframe)
           │        └                                        address   area  constraction_year  ...  furnished_yes  garage_yes  storage_yes
           │          0     1...
           └ <function _get_x_y at 0x7ff973c2e520>

  File "/home/mamadou/datascience2ml/src/model/pipeline/model.py", line 100, in _get_x_y
    X = df[col_x]
        │  └ ['area', 'construction_year', 'bedrooms', 'garden', 'balcony_yes', 'parking_yes', 'furnished_yes', 'garage_yes', 'storage_yes']
        └                                        address   area  constraction_year  ...  furnished_yes  garage_yes  storage_yes
          0     1...

  File "/home/mamadou/.cache/pypoetry/virtualenvs/datascience2ml-hbib5JLl-py3.12/lib/python3.12/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              │    │                           └ ['area', 'construction_year', 'bedrooms', 'garden', 'balcony_yes', 'parking_yes', 'furnished_yes', 'garage_yes', 'storage_yes']
              │    └ <pandas._libs.properties.AxisProperty object at 0x7ff98f864730>
              └                                        address   area  constraction_year  ...  furnished_yes  garage_yes  storage_yes
                0     1...
  File "/home/mamadou/.cache/pypoetry/virtualenvs/datascience2ml-hbib5JLl-py3.12/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
    │    │                 │       │        └ 'columns'
    │    │                 │       └ array([ 1, -1,  4,  6, 12, 13, 14, 15, 16])
    │    │                 └ Index(['area', 'construction_year', 'bedrooms', 'garden', 'balcony_yes',
    │    │                          'parking_yes', 'furnished_yes', 'garage_yes',...
    │    └ <function Index._raise_if_missing at 0x7ff98fcb1260>
    └ Index(['address', 'area', 'constraction_year', 'rooms', 'bedrooms',
             'bathrooms', 'garden', 'energy', 'facilities', 'zi...
  File "/home/mamadou/.cache/pypoetry/virtualenvs/datascience2ml-hbib5JLl-py3.12/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
                      └ ['construction_year']

KeyError: "['construction_year'] not in index"
2024-10-19 02:55:50.333 | INFO     | __main__:main:18 - Starting the prediction process, running         the application ...
2024-10-19 02:55:50.334 | INFO     | model.model_builder:train_model:47 - Checking the existence of model config file ...
2024-10-19 02:55:50.334 | WARNING  | model.model_builder:train_model:55 - Model not found at model/models/random_forest_db_version_0.1.0.joblib -> Building a new random_forest_db model ...
2024-10-19 02:55:50.334 | INFO     | model.pipeline.model:build_model:42 - Starting  Building Model Pipeline ...
2024-10-19 02:55:50.335 | INFO     | model.pipeline.preparation:prepare_data:33 - Preparing data pipeline processing ...
2024-10-19 02:55:50.335 | INFO     | model.pipeline.collect:load_data_from_db:53 - Loading data from database ...
2024-10-19 02:55:50.381 | INFO     | model.pipeline.preparation:encode_cat_cols:79 - Encoding categorical columns ['balcony', 'parking', 'furnished', 'garage', 'storage']
2024-10-19 02:55:50.397 | INFO     | model.pipeline.preparation:parse_garden_col:106 - Parsing garden column ...
2024-10-19 02:55:50.399 | INFO     | model.pipeline.model:_get_x_y:99 - Getting X, y data ...
2024-10-19 02:55:50.401 | INFO     | model.pipeline.model:split_train_test:136 - Splitting data in train and test ...
2024-10-19 02:55:50.404 | INFO     | model.pipeline.model:train_model:159 - Training model and tunning hyperparams ...
2024-10-19 02:55:50.405 | DEBUG    | model.pipeline.model:train_model:162 - Grid Space is {'n_estimators': [100, 200, 300], 'max_depth': [3, 6, 9, 12]}  ...
2024-10-19 02:56:03.071 | INFO     | model.pipeline.model:evaluate_model:190 - Evaluating Model, Score is 0.72
2024-10-19 02:56:03.072 | INFO     | model.pipeline.model:save_model:214 - Saving Model at model/models/random_forest_db_version_0.1.0.joblib
2024-10-19 02:56:03.506 | INFO     | __main__:main:25 - Training Model completed ...
